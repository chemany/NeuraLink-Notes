# PPTX功能测试指南

## 🎯 测试目标
验证PPTX文件的完整工作流程：上传 → 处理 → 预览 → 向量化 → AI分析

## 🚀 服务状态
- **后端服务**: ✅ http://127.0.0.1:3001
- **前端服务**: ✅ http://localhost:3000
- **编译状态**: ✅ 所有错误已修复
- **功能状态**: ✅ 完整实现并可测试
- **最新修复**: ✅ PPTX预览支持已启用（2025-07-27 修复）

## 📋 测试步骤

### 1. 基础功能测试

#### 1.1 PPTX文件上传
1. 访问 http://localhost:3000
2. 登录系统
3. 进入文档管理界面
4. 点击"上传文档"按钮
5. 选择一个PPTX文件进行上传
6. **预期结果**: 文件成功上传，状态显示为"处理中"

#### 1.2 文档处理状态监控
1. 上传后观察文档状态变化
2. **预期状态变化**: PENDING → PROCESSING → COMPLETED
3. **预期时间**: 通常在30秒-2分钟内完成
4. **如果失败**: 状态会显示为FAILED，查看后端日志

#### 1.3 PPTX预览功能
1. 文档处理完成后，点击文档进行预览
2. **预期行为**: 
   - 优先显示Office Online Viewer (iframe)
   - 如果失败，显示提取的文本内容
   - 提供"在线预览"和"下载文件"按钮
3. **测试要点**:
   - 预览加载速度
   - 内容显示完整性
   - 错误处理机制

### 2. 向量化功能测试

#### 2.1 自动向量化触发
1. 文档状态变为COMPLETED后
2. 系统应自动开始向量化处理
3. **监控方法**: 查看浏览器控制台日志
4. **预期日志**: 
   ```
   [VectorService] 开始处理文档: filename.pptx
   [VectorService] 从 PPTX 提取文本完成
   [VectorService] 开始将 X 个文档块存储到后端
   ```

#### 2.2 向量化状态检查
1. 在文档列表中查看向量化状态
2. **预期状态**: VECTORIZATION_COMPLETED
3. **如果失败**: 状态显示VECTORIZATION_FAILED，但仍可进行AI分析

### 3. AI分析功能测试

#### 3.1 基于PPTX内容的问答
1. 等待向量化完成（或失败但有文本内容）
2. 进入AI聊天界面
3. 提问与PPTX内容相关的问题
4. **测试问题示例**:
   - "这个演示文稿的主要内容是什么？"
   - "总结一下第一张幻灯片的要点"
   - "文档中提到了哪些关键概念？"

#### 3.2 检索质量验证
1. **预期行为**: AI能够基于PPTX内容回答问题
2. **检查要点**:
   - 回答是否基于实际的PPTX内容
   - 是否能正确引用幻灯片信息
   - 回答的准确性和相关性

### 4. 错误处理测试

#### 4.1 损坏文件测试
1. 上传一个损坏的PPTX文件
2. **预期行为**: 系统应优雅处理错误，显示错误信息

#### 4.2 大文件测试
1. 上传一个较大的PPTX文件（>10MB）
2. **预期行为**: 系统应能正常处理，可能需要更长时间

#### 4.3 复杂内容测试
1. 上传包含图片、表格、动画的复杂PPTX
2. **预期行为**: 至少能提取文本内容，忽略多媒体元素

## 🔍 故障排除

### 常见问题及解决方案

#### 问题1: 文档上传失败
- **检查**: 文件大小是否超限
- **解决**: 确认后端上传限制配置

#### 问题2: 文本提取失败
- **检查**: 后端日志中的错误信息
- **可能原因**: textract或pptx2json库问题
- **解决**: 检查依赖安装，重启后端服务

#### 问题3: 预览显示异常
- **检查**: 浏览器控制台错误
- **可能原因**: Office Online Viewer访问问题
- **解决**: 应自动回退到文本预览

#### 问题4: 向量化失败
- **检查**: 前端控制台和后端日志
- **影响**: 不影响AI分析，仍可使用原始文本
- **解决**: 检查向量化服务配置

#### 问题5: AI分析无响应
- **检查**: 文档是否有文本内容
- **可能原因**: LLM配置问题
- **解决**: 检查AI服务配置和API密钥

## 📊 性能基准

### 预期处理时间
- **小文件** (<1MB): 10-30秒
- **中等文件** (1-5MB): 30秒-2分钟
- **大文件** (5-20MB): 2-5分钟

### 预期成功率
- **文本提取**: >95%
- **预览显示**: >90%
- **向量化**: >85%
- **AI分析**: >95%

## 🧪 测试用例

### 推荐测试文件
1. **简单演示**: 纯文本幻灯片，5-10页
2. **复杂演示**: 包含图片和表格，20-30页
3. **大型演示**: 50+页的详细演示文稿
4. **多语言**: 包含中英文混合内容

### 测试检查清单
- [ ] 文件上传成功
- [ ] 文本提取完成
- [ ] 预览功能正常
- [ ] 向量化处理成功
- [ ] AI问答功能正常
- [ ] 错误处理机制有效
- [ ] 性能表现符合预期

## 📝 测试报告模板

```
测试时间: [日期时间]
测试文件: [文件名和大小]
测试结果:
- 上传: ✅/❌
- 文本提取: ✅/❌ (提取字符数: X)
- 预览: ✅/❌ (使用方案: Office Online/文本预览)
- 向量化: ✅/❌
- AI分析: ✅/❌
- 总体评分: X/10

问题记录:
[记录遇到的问题和解决方案]

改进建议:
[记录改进建议]
```

## 🎉 测试完成标准

当以下条件全部满足时，PPTX功能测试通过：
1. ✅ 能成功上传和处理PPTX文件
2. ✅ 文本提取功能正常工作
3. ✅ 预览功能至少有一种方案可用
4. ✅ 向量化流程能够执行（成功或失败都可接受）
5. ✅ AI能够基于PPTX内容进行问答
6. ✅ 错误处理机制工作正常

---

**准备就绪！开始测试PPTX功能吧！** 🚀
